# 项目命名规范修复工具使用指南

## 概述

这套工具是为解决项目中的命名规范问题而开发的。根据检查脚本的输出，项目存在以下几类命名问题：

1. 目录命名不规范（需要使用kebab-case命名法）
2. 样式文件命名不规范（需要使用PascalCase命名法）
3. 样式文件与组件名不匹配

本工具包含多个脚本，可以自动化修复这些问题。

## 安装和准备

这些脚本使用Node.js开发，无需额外依赖。确保您的环境满足以下要求：

- Node.js 12.0.0 或更高版本
- 使用前请先备份或提交您的代码，以防意外情况发生

## 使用流程

### 第1步：检查命名问题

首先运行检查脚本，查看项目中的命名问题：

```bash
node scripts/naming-check.js
```

这将显示所有不符合命名规范的文件和目录。

### 第2步：修复命名问题

#### 方法1：使用一键修复脚本（推荐）

一键修复脚本会按正确的顺序执行所有修复步骤：

```bash
# 先执行试运行，查看会进行哪些修改（不实际更改文件）
node scripts/fix-all-naming.js --dry-run

# 确认无误后，实际执行修复
node scripts/fix-all-naming.js
```

脚本会引导您逐步完成修复流程，每一步都可以选择是否执行。

#### 方法2：分步执行修复脚本

如果您希望更精细地控制修复过程，可以按以下顺序分步执行：

1. **修复目录命名**

```bash
# 试运行模式
node scripts/fix-directory-naming.js --dry-run

# 实际执行修复
node scripts/fix-directory-naming.js

# 分批次执行（每批5个目录）
node scripts/fix-directory-naming.js --batch 5
```

2. **修复样式文件命名**

```bash
# 试运行模式
node scripts/fix-style-naming.js --dry-run

# 实际执行修复
node scripts/fix-style-naming.js

# 分批次执行
node scripts/fix-style-naming.js --batch 5

# 不修复样式文件与组件名不匹配的问题
node scripts/fix-style-naming.js --no-match-fix
```

3. **更新导入路径**

```bash
# 试运行模式
node scripts/update-import-paths.js --dry-run

# 实际执行更新
node scripts/update-import-paths.js

# 查看详细日志
node scripts/update-import-paths.js --verbose
```

### 第3步：验证修复结果

修复完成后，建议执行以下步骤：

1. 运行命名检查脚本，确认问题已解决：
   ```bash
   node scripts/naming-check.js
   ```

2. 启动项目，确保功能正常运行
   
3. 运行项目测试套件，验证没有引入新的问题

## 脚本说明

### naming-check.js

检查项目中不符合命名规范的文件和目录。该脚本不会修改任何文件，只会报告问题。

### fix-directory-naming.js

修复目录命名问题，将不符合kebab-case的目录重命名为kebab-case。脚本会从深层目录开始修复，避免路径依赖问题。

参数：
- `--dry-run`：试运行模式，不实际修改文件
- `--batch <数量>`：分批次执行，每批处理指定数量的目录

### fix-style-naming.js

修复样式文件命名问题，将样式文件重命名为PascalCase，并解决样式文件与组件名不匹配的问题。

参数：
- `--dry-run`：试运行模式，不实际修改文件
- `--batch <数量>`：分批次执行，每批处理指定数量的文件
- `--no-match-fix`：不修复样式文件与组件名不匹配的问题

### update-import-paths.js

更新代码中的导入路径，以匹配重命名后的文件和目录。

参数：
- `--dry-run`：试运行模式，不实际修改文件
- `--verbose`：显示详细日志，包括未修改的文件
- `--batch <数量>`：分批次执行，每批处理指定数量的文件

### rename-logger.js

用于记录重命名操作的工具类。它将重命名记录保存到JSON文件中，以便在过程中断时可以继续执行。

### fix-all-naming.js

协调运行所有修复脚本的主脚本，按正确的顺序调用各个修复脚本。

参数：
- `--dry-run`：试运行模式，所有子脚本都不会实际修改文件
- `--batch <数量>`：设置所有子脚本的批处理数量

## 高级用法

### 自定义重命名映射

如果需要自定义重命名规则，可以修改 `update-import-paths.js` 中的 `generateRenameMapping` 函数：

1. 打开 `update-import-paths.js` 文件
2. 找到 `generateRenameMapping` 函数
3. 修改 `manualDirRenames` 和 `manualStyleRenames` 数组，添加自定义的重命名映射

例如：

```javascript
const manualDirRenames = [
  { oldPath: 'app/auth/login/components/LoginForm', newPath: 'app/auth/login/components/login-form' },
  // 添加更多自定义映射...
];
```

### 处理特殊情况

某些特殊情况可能需要手动处理：

1. **复杂的导入路径**：脚本尽力更新所有导入路径，但对于非标准导入（如动态导入）可能需要手动修复
2. **第三方库引用**：确保第三方库的引用路径正确
3. **构建配置**：检查webpack、babel等构建工具的配置文件中的路径引用

## 故障排除

### 错误：目录重命名失败

可能原因：
- 目录被其他进程锁定
- 权限不足
- 目标路径已存在

解决方法：
- 关闭可能锁定文件的程序（如IDE、编辑器）
- 以管理员权限运行脚本
- 手动检查目标路径是否已存在

### 错误：导入路径更新失败

可能原因：
- 文件编码问题
- 非标准导入语法

解决方法：
- 确保文件使用UTF-8编码
- 手动检查并修复复杂的导入语句

### 脚本执行中断

如果脚本执行过程中断，重新运行脚本时会从中断处继续。已完成的重命名操作记录在 `directory-renames.json` 和 `style-renames.json` 文件中。

## 最佳实践

1. **先进行试运行**：使用 `--dry-run` 参数先预览将进行的更改
2. **分批处理**：对于大型项目，使用 `--batch` 参数分批处理，便于审查和控制
3. **先提交代码**：在执行修复前先提交或备份代码
4. **逐步修复**：按推荐顺序执行修复步骤
5. **及时验证**：每一步完成后进行验证 